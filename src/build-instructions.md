# 隐患排查软件 - 桌面版打包说明

## 🚀 打包成exe文件教程

本文档将指导您如何将隐患排查软件打包成独立的Windows可执行文件（.exe），用户无需安装浏览器即可直接运行。

## 📋 前置要求

### 1. 安装Node.js
1. 访问 [Node.js官网](https://nodejs.org/) 下载LTS版本
2. 安装时选择"Add to PATH"选项
3. 验证安装：打开命令提示符执行
   ```bash
   node --version
   npm --version
   ```

### 2. 项目文件检查
确保项目目录包含以下文件：
```
隐患排查软件/
├── package.json                # ✅ 已创建
├── electron-main.js            # ✅ 已创建
├── index.html                  # ✅ 原有文件
├── styles.css                  # ✅ 原有文件
├── script.js                   # ✅ 原有文件
├── chaoshi.jpg                 # ✅ 原有文件
├── shangchang.jpg              # ✅ 原有文件
├── sushe.jpg                   # ✅ 原有文件
├── xiaoqu.jpg                  # ✅ 原有文件
├── zuoye.jpg                   # ✅ 原有文件
└── icon.ico                    # ⚠️ 需要添加（应用图标）
```

## 🎯 打包步骤

### 第一步：安装依赖
在项目目录打开命令提示符（Shift+右键 → "在此处打开PowerShell窗口"），执行：

```bash
npm install
```

这将安装Electron和打包工具。

### 第二步：创建应用图标（可选）
1. 准备一个256x256像素的PNG图片
2. 使用在线工具转换为ICO格式：https://convertico.com/
3. 保存为 `icon.ico` 放在项目根目录

如果不添加图标，程序将使用默认图标。

### 第三步：测试运行
```bash
npm start
```
这将启动Electron版本的应用，确保功能正常。

### 第四步：打包生成exe
根据需要选择以下命令之一：

```bash
# 生成64位exe（推荐）
npm run build-win64

# 生成32位exe（兼容老旧系统）
npm run build-win32

# 同时生成32位和64位
npm run build-win
```

### 第五步：获取打包结果
打包完成后，在 `dist` 文件夹中可以找到：

1. **安装程序版本**：`隐患排查教育软件 Setup 1.2.0.exe`
   - 用户需要安装才能使用
   - 会在开始菜单和桌面创建快捷方式
   - 支持自动更新（如果配置）

2. **便携版本**：`隐患排查教育软件-1.2.0-portable.exe`
   - 免安装，直接运行
   - 适合U盘携带
   - 推荐用于教学环境

## 📦 打包配置说明

### 输出文件类型
- **NSIS安装程序**：标准的Windows安装程序
- **Portable便携版**：免安装的单文件exe

### 应用特性
- ✅ 独立运行，无需浏览器
- ✅ 支持32位和64位Windows系统
- ✅ 包含完整的应用菜单
- ✅ 支持快捷键（F5刷新、F11全屏、Ctrl+Q退出等）
- ✅ 防止多实例运行
- ✅ 自动处理缩放和全屏
- ✅ 安全的Web内容渲染

## 🔧 高级配置

### 修改应用信息
编辑 `package.json` 中的以下字段：
```json
{
  "name": "应用内部名称",
  "version": "版本号",
  "description": "应用描述",
  "author": "开发者信息"
}
```

### 自定义窗口设置
编辑 `electron-main.js` 中的窗口配置：
```javascript
mainWindow = new BrowserWindow({
  width: 1200,        // 默认宽度
  height: 800,        // 默认高度
  minWidth: 1024,     // 最小宽度
  minHeight: 768,     // 最小高度
  resizable: true,    // 是否可调整大小
  fullscreenable: true // 是否支持全屏
});
```

## 🐛 常见问题

### 问题1：npm install失败
**解决方案**：
1. 检查网络连接
2. 使用国内镜像：`npm config set registry https://registry.npmmirror.com`
3. 清除缓存：`npm cache clean --force`

### 问题2：打包时出现权限错误
**解决方案**：
1. 以管理员身份运行命令提示符
2. 临时关闭杀毒软件
3. 将项目文件夹添加到杀毒软件白名单

### 问题3：exe文件被误报为病毒
**解决方案**：
1. 这是常见的误报，因为Electron应用包含可执行代码
2. 将生成的exe添加到杀毒软件白名单
3. 如需分发，可以考虑代码签名证书

### 问题4：应用启动缓慢
**解决方案**：
1. 第一次启动会较慢，后续会改善
2. 可以在启动画面添加加载提示
3. 考虑启用应用预加载

## 📊 文件大小参考
- **便携版exe**：约150-200MB
- **安装程序**：约150-200MB
- **安装后占用空间**：约300-400MB

大小主要由Electron框架决定，这是正常现象。

## 🚀 分发建议

### 企业内部使用
- 推荐使用**便携版**，放在共享文件夹
- 无需安装，直接运行
- 方便版本更新和管理

### 个人用户
- 推荐使用**安装程序版本**
- 会在系统中正确注册
- 支持开始菜单和桌面快捷方式

### 教学环境
- 推荐使用**便携版**
- 可以放在U盘中携带
- 在任何Windows电脑上都能运行

## 🎉 完成！

按照以上步骤，您就可以获得一个完全独立的Windows桌面应用程序，用户无需安装浏览器或其他依赖，双击即可运行隐患排查教育软件。

如有问题，请查看上述常见问题部分或联系技术支持。 